<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image Grid</title>
    <style>
      .grid {
        /* (Max Tracks / 5) + 0.2 */
        width: calc(75px * 6.5);
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        gap: 0.5em;
      }
      .gridItem {
        height: 75px;
        border-radius: 0.6em;
        box-shadow: 0px 4px 4px 2px rgba(0, 0, 0, 0.25);
      }
    </style>
  </head>
  <body>
    <div class="grid">
      <!-- <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" />
      <img src="https://is1-ssl.mzstatic.com/image/thumb/Features125/v4/cf/9b/96/cf9b9637-f619-eceb-5382-e9b4d44e74fb/dj.npwkgmai.jpg/512x512bb.jpg" alt="" class="gridItem" /> -->
    </div>
    <script>
      let grid = document.querySelector('.grid');
      let maxTracksShown = 30;
      let trackList = [];
      function fetchLastTracks() {
        let elems = [];
        fetch('/tracks/history').then(r =>
          r.json().then(res => {
            // console.log(res);
            if (res.success) {
              let { data: tracks } = res;
              tracks = Object.values(tracks)
                .filter(t => t.id !== '0' && t.id !== res.currentTrackId)
                .sort((a, b) => b.addedTimestamp - a.addedTimestamp);
              tracks = tracks.slice(0, maxTracksShown);
              trackList = tracks;
              trackList.forEach(track => {
                let elem = document.createElement('img');
                elem.setAttribute('src', track.imageUrl);
                elem.classList.add('gridItem');
                elems.push(elem);
              });
              grid.replaceChildren(...elems);
              //   console.log(tracks);
            }
          })
        );
      }

      setInterval(fetchLastTracks, 2000);
    </script>
  </body>
</html>
